#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\begin_modules
knitr
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2.5cm
\topmargin 2.5cm
\rightmargin 2.5cm
\bottommargin 2.5cm
\secnumdepth 2
\tocdepth 2
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\noindent
\align left
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="right" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LINKÖPING UNIVERSITY
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2018-08-22
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dept.
 of Computer and Information Science
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 4.7cm
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bayesian Learning, 6 hp
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Division of Statistics and Machine Learning
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
732A91/TDDE07 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Per Sidén
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 0.3cm
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align left
\begin_inset Tabular
<lyxtabular version="3" rows="35" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size large
Computer Exam - Bayesian Learning (732A91/TDDE07), 6 hp
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset line
LatexCommand rule
offset "0cm"
width "97.5col%"
height "1pt"

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Time:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14-18
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Allowable material:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
- The allowed material in the folder given_files in the exam system.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
- Calculator with erased memory.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Teacher:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mattias Villani.
 Phone: 
\begin_inset Formula $070-0895205$
\end_inset

 and through the Communication client.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exam scores:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Maximum number of credits on the exam: 40.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Maximum number of credits on each exam question: 10.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Grades (732A91):
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
A: 36 points 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
B: 32 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
C: 24 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
D: 20 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
E: 16 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
F: <16 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Grades (TDDE07):
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5: 34 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4: 26 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3: 18 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
U: <18 points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\color red
INSTRUCTIONS
\series default
\color inherit
:
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
When asked to give a solution on 
\series bold
\color blue
Paper
\series default
\color black
, give that answer on physical papers supplied with the exam.
 
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color black
Each submitted sheet of paper should be marked with your 
\emph on
Client ID
\emph default
 from the 
\emph on
Communication Clien
\emph default
t.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The client ID is the code in the
\color black
 
\family typewriter
\color red
red
\family default
\color black
 dashed rectangle in figure below.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color black
All other answers should be submitted in a single PDF file using the 
\emph on
Communication Client.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Include important code needed to grade the exam (inline or at the end of
 the PDF).
 
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color black
Submission starts by clicking the button in the 
\family typewriter
\color lime
green
\family default
\color black
 solid rectangle in figure below.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The submitted PDF file should be named 
\emph on
BayesExam.pdf
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Questions can be asked through the Communication client (
\family typewriter
\color blue
blue
\family default
\color black
 dotted rectangle in figure below).
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Full score requires clear and well motivated answers.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset line
LatexCommand rule
offset "0cm"
width "97.5col%"
height "1pt"

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename ../CommunicationClient.png
	lyxscale 40
	scale 33

\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Enumerate

\shape smallcaps
The log-normal model
\shape default

\begin_inset VSpace medskip
\end_inset


\begin_inset Newline newline
\end_inset

The file 
\family typewriter
lions
\family default
 which is loaded by the code in 
\family typewriter
ExamData.R
\family default
 contains the reported weights in kg of 92 captured male lions.
 Let 
\begin_inset Formula $\boldsymbol{x}=\left\{ x_{1},x_{2},\ldots,x_{n}\right\} $
\end_inset

 denote the weights and assume a log-normal model 
\begin_inset Formula $x_{1},\ldots,x_{n}|\mu,\sigma^{2}\overset{iid}{\sim}\mathrm{lognormal}\left(\mu,\sigma^{2}\right)$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Enumerate

\emph on
Credits: 4p.

\emph default
 Assume for now that we know that 
\begin_inset Formula $\sigma^{2}=0.04$
\end_inset

.
 Plot the posterior distribution of 
\begin_inset Formula $\mu$
\end_inset

 based on the data in the supplied file 
\family typewriter
\color black
lions.RData
\family default
\color inherit
.

\series bold
\color blue
 
\series default
\color inherit
Use the prior 
\begin_inset Formula $\mu\sim N(5,1)$
\end_inset

.
 Make sure that the plotted posterior is a valid (normalized) density function.
 [Hint: The lognormal density function is available in 
\family typewriter
R
\family default
 as 
\family typewriter
dlnorm
\family default
.]
\begin_inset Newline newline
\end_inset


\series bold
\color blue
Solution
\series default
\color inherit
: See 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\begin_layout Enumerate

\emph on
Credits: 4p.

\emph default
 Now assume that also 
\begin_inset Formula $\sigma^{2}$
\end_inset

 is unknown and that 
\begin_inset Formula $\sigma^{2}\sim Inv\text{-}\chi^{2}(\nu_{0},\sigma_{0}^{2})$
\end_inset

 a priori independently from 
\begin_inset Formula $\mu$
\end_inset

, with 
\begin_inset Formula $\nu_{0}=5$
\end_inset

 and 
\begin_inset Formula $\sigma_{0}^{2}=0.04$
\end_inset

.
 Implement Stan-code that produces at least 2000 samples from the posterior
 of 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 Use 500 samples for burnin.
 Based on the samples compute the posterior mean and standard deviation
 of 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\sigma^{2}$
\end_inset

 and plot the joint posterior of 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 [Hint: The lognormal sampling statement in Stan is 
\family typewriter
y~lognormal(mu,sigma);
\family default
].
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: See 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\begin_layout Enumerate

\emph on
Credits: 2p.

\emph default
 It is of interest to compute an estimate of the average weight of male
 lions.
 Give an estimate and a 95% credible interval of the average weight of male
 lions based on the posterior computed in (b).
 [Hint: The mean of the lognormal distribution is 
\begin_inset Formula $\exp\left(\mu+\frac{1}{2}\sigma^{2}\right)$
\end_inset

.].
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: See 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\end_deeper
\begin_layout Enumerate

\shape smallcaps
Logistic regression
\shape default

\begin_inset VSpace medskip
\end_inset


\begin_inset Newline newline
\end_inset

The file 
\family typewriter
titanic
\family default
 which is loaded by the code in 
\family typewriter
ExamData.R
\family default
 contains the information about 1316 passengers on the ship Titanic that
 sunk in the Atlantic ocean in April 1912.
 This was a big disaster.
 Descriptions of the variables presented in the table below.
 A passenger could travel in first, second or third class.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

 
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Variable
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Data type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Meaning
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Role
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Survived
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Whether or not the passenger survived
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Response
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Intercept
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Constant to the intercept
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Feature
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Adult
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Whether or not the passenger was an adult
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Feature
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Man
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Whether or not the passenger was a man
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Feature
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Class1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Whether or not the passenger travelled in first class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Feature
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Class2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Whether or not the passenger travelled in second class
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Feature
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate

\emph on
Credits: 4p.

\emph default
 Consider the logistic regression
\begin_inset Formula 
\[
\mathrm{Pr}(y=1\vert\mathbf{x})=\frac{\exp\left(\mathbf{x}^{T}\boldsymbol{\beta}\right)}{1+\exp\left(\mathbf{x}^{T}\boldsymbol{\beta}\right)},
\]

\end_inset

where 
\begin_inset Formula $y$
\end_inset

 is the binary variable with 
\begin_inset Formula $y=1$
\end_inset

 if the passenger survived and 
\begin_inset Formula $y=0$
\end_inset

 otherwise.
 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is a 
\begin_inset Formula $5$
\end_inset

-dimensional vector containing the five features (including a one for the
 constant term that models the intercept) and 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 is the corresponding vector of coefficients.
 Use numerical optimization to obtain a normal approximation of the 
\emph on
joint
\emph default
 posterior distribution of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

.
 Use the prior 
\begin_inset Formula $\boldsymbol{\beta}\sim\mathcal{N}(0,\tau^{2}I)$
\end_inset

, with 
\begin_inset Formula $\tau=50$
\end_inset

.
 Plot the marginal posterior distribution of each variable except the intercept,
 using your approximation.
 For full points, use the probability density function (pdf) to construct
 the plots.
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: See 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\begin_layout Enumerate

\emph on
Credits: 2p.

\emph default
 Compute the posterior probability that the 
\begin_inset Formula $\beta_{i}$
\end_inset

 corresponding to the adult feature is smaller than 0.
 Interpret this probability.
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: See 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\begin_layout Enumerate

\emph on
Credits: 4p.

\emph default
 A first class adult woman and a third class adult man are together during
 the disaster.
 Compute the predictive probability that the woman survives but the man
 dies.
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: See 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\end_deeper
\begin_layout Enumerate

\shape smallcaps
Geometric model comparison
\shape default

\begin_inset VSpace medskip
\end_inset


\begin_inset Newline newline
\end_inset

Let 
\begin_inset Formula $x_{1},...,x_{n}\vert\theta\overset{iid}{\sim}\mathrm{Geometric}(\theta)$
\end_inset

.
 The Geometric distribution has probability function
\begin_inset Formula 
\[
p(x\vert\theta)=(1-\theta)^{x}\theta,\text{ for }x=0,1,2,...,
\]

\end_inset

and zero otherwise.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate

\emph on
Credits: 3p.

\emph default
 Derive the posterior distribution 
\begin_inset Formula $p(\theta\vert x_{1},...,x_{n})$
\end_inset

 on 
\series bold
\color blue
Paper
\series default
\color inherit
 using the conjugate 
\begin_inset Formula $\mathrm{Beta}(\alpha,\beta)$
\end_inset

 prior.
 
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: 
\begin_inset Formula 
\begin{align*}
p(\theta\vert x_{1},...,x_{n}) & \propto p(x_{1},...,x_{n}\vert\theta)p(\theta)\\
 & \propto(1-\theta)^{\text{∑}_{i=1}^{n}x_{i}}\theta^{n}\cdot\theta^{\alpha-1}(1-\theta)^{\beta-1}\\
 & =\theta^{n+\alpha-1}(1-\theta)^{\text{∑}_{i=1}^{n}x_{i}+\beta-1}
\end{align*}

\end_inset

which is proportional to the 
\begin_inset Formula $\mathrm{Beta}(n+\alpha,n\bar{x}+\beta)$
\end_inset

 density, where 
\begin_inset Formula $\bar{x}$
\end_inset

 is the data mean.
\end_layout

\begin_layout Enumerate

\emph on
Credits: 3p.

\emph default
 Derive the marginal likelihood of the data for the geometric model with
 Beta prior on 
\series bold
\color blue
Paper
\series default
\color inherit
 .
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: The marginal likelihood can be computed using
\begin_inset Formula 
\begin{align*}
p\left(x_{1},\ldots,x_{n}\right) & =\frac{p(x_{1},\ldots,x_{n}|\theta)p\left(\theta\right)}{p\left(\theta|x_{1},\ldots,x_{n}\right)}\\
 & =\frac{(1-\theta)^{n\bar{x}}\theta^{n}\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}\theta^{\alpha-1}\left(1-\theta\right)^{\beta-1}}{\frac{\Gamma(n+\alpha+n\bar{x}+\beta)}{\Gamma(n+\alpha)\Gamma(n\bar{x}+\beta)}\theta^{n+\alpha-1}\left(1-\theta\right)^{n\bar{x}+\beta-1}}\\
 & =\frac{\Gamma(\alpha+\beta)\Gamma(n+\alpha)\Gamma(n\bar{x}+\beta)}{\Gamma(\alpha)\Gamma(\beta)\Gamma(n+n\bar{x}+\alpha+\beta)}.
\end{align*}

\end_inset


\end_layout

\begin_layout Enumerate

\emph on
Credits: 4p.

\emph default
 Assume that we have 
\begin_inset Formula $n=3$
\end_inset

 observations, 
\begin_inset Formula $x_{1}=2$
\end_inset

, 
\begin_inset Formula $x_{2}=1$
\end_inset

 and 
\begin_inset Formula $x_{3}=12$
\end_inset

.
 Do a Bayesian model comparison of the following two models, which both
 have the geometric likelihood, and where the first uses the Beta prior
 with 
\begin_inset Formula $\alpha=0.5$
\end_inset

 and 
\begin_inset Formula $\beta=0.5$
\end_inset

 and the second is a null model which assumes that 
\begin_inset Formula $\theta$
\end_inset

 is known with 
\begin_inset Formula $\theta=0.5$
\end_inset

.
 Assume the prior probabilities 
\begin_inset Formula $p(M_{1})=\frac{1}{10}$
\end_inset

 and 
\begin_inset Formula $p\left(M_{2}\right)=\frac{9}{10}$
\end_inset

.
 State your conclusions.
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: The Bayesian model comparison is carried out by computing the marginal
 likelihood for the two models, and then using the posterior model probabilities
\begin_inset Formula 
\[
p\left(M_{i}|x\right)\propto p\left(x|M_{i}\right)p\left(M_{i}\right).
\]

\end_inset

Model 2 has no unknown parameters so the marginal likelihood reduces to
 the likelihood as defined in (a), while the marginal likelihood for Model
 1 can be computed using the result in (b) (this can also be found in the
 Lecture 10 slides if (b) was not solved).
 See the numerical computations in 
\family typewriter
Exam732A91_180822_Sol.R
\family default
.
 The computed posterior model probabilities are 
\begin_inset Formula $(0.62,0.38)$
\end_inset

 for the two models, so Model 1 is the most probable given the data.
\end_layout

\end_deeper
\begin_layout Enumerate

\shape smallcaps
Election
\shape default

\begin_inset VSpace medskip
\end_inset


\begin_inset Newline newline
\end_inset

The day before a political election, an opinion poll asked 400 randomly
 selected registered voters about which party they were going to vote for.
 There exists only three parties, and the answers were distributed in the
 following way (party A: 184, party B: 67, party C: 149).
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate

\emph on
Credits: 3p.

\emph default
 Assume a multinomial model for the data and a non-informative Dirichlet
 prior.
 On
\series bold
\color blue
 Paper
\series default
\color inherit
, derive the posterior distribution of the underlying share of voters for
 each party.
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: The multinomial model is
\begin_inset Formula 
\[
p(y|\theta)\propto\prod_{k=1}^{K}\theta_{k}^{y_{k}},\text{ where }\sum_{k=1}^{K}\theta_{k}=1,
\]

\end_inset

where 
\begin_inset Formula $y_{k}$
\end_inset

 is the number of answers for party 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $\theta_{k}$
\end_inset

 is the underlying share of voters for party 
\begin_inset Formula $k$
\end_inset

.
 The non-informative Dirichlet prior is
\begin_inset Formula 
\[
p(\theta)\propto\prod_{k=1}^{K}\theta_{k}^{\alpha_{k}-1},
\]

\end_inset

where we set 
\begin_inset Formula $\alpha_{1}=\alpha_{2}=\alpha_{3}=1$
\end_inset

 to make this prior non-informative.
 The posterior is
\begin_inset Formula 
\begin{align*}
p(\theta|y) & \propto p(y|\theta)p(\theta)\\
 & \propto\prod_{k=1}^{K}\theta_{k}^{y_{k}}\prod_{k=1}^{K}\theta_{k}^{\alpha_{k}-1}\\
 & \propto\prod_{k=1}^{K}\theta_{k}^{y_{k}+\alpha_{k}-1}.
\end{align*}

\end_inset

So, 
\begin_inset Formula $\theta|y\sim\mathrm{Dirichlet}(\alpha_{1}+y_{1},\alpha_{2}+y_{2},\alpha_{3}+y_{3})=\mathrm{Dirichlet}(185,68,150).$
\end_inset


\end_layout

\begin_layout Enumerate

\emph on
Credits: 1p.

\emph default
 Compute the probability that party A gets a majority of the votes (more
 than 50%) in the election.
 Assume that everyone in the population is voting.
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: See 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\begin_layout Enumerate

\emph on
Credits: 2p.

\emph default
 Compute the probability that party A becomes the largest party.

\series bold
\color blue
 
\series default
\color inherit
Assume that everyone in the population is voting.
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: See 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\begin_layout Enumerate

\emph on
Credits: 2p.

\emph default
 Assume that the probability in (c) was estimated using Monte Carlo with
 10000 independent posterior samples.
 If (c) was not solved, assume that the answer was 0.9.
 Compute a 95% confidence interval for the estimated probability in (c)
 with respect to the error from the Monte Carlo estimation.
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: The Monte Carlo estimate can be seen as an average of 10000 Bernoulli
 random variables and the central limit theorem gives that this average
 is approximately normal.
 So the standard deviation of the estimate is 
\begin_inset Formula 
\[
\sqrt{\frac{1}{10000}\left(1-0.9\right)0.9}=0.003.
\]

\end_inset

So a 95% confidence interval is 
\begin_inset Formula $0.9\pm1.96\cdot0.003=\left(0.894,0.906\right).$
\end_inset

 Also see 
\family typewriter
\color black
Exam732A91_180822_Sol.R
\family default
\color inherit
.
\end_layout

\begin_layout Enumerate

\emph on
Credits: 2p.

\emph default
 How many additional samples would be needed to reduce the width of the
 interval in (d) by half?
\series bold
\color blue

\begin_inset Newline newline
\end_inset

Solution
\series default
\color inherit
: According to the slides of Lecture 8, the variance of a Monte Carlo estimate
 with 
\begin_inset Formula $N$
\end_inset

 iid samples is 
\begin_inset Formula $\sigma^{2}/N$
\end_inset

, where 
\begin_inset Formula $\sigma^{2}$
\end_inset

 is the variance of each sample.
 The width of the interval in (d) is 
\begin_inset Formula $2\sqrt{\sigma^{2}/10000}$
\end_inset

, so to get the number of samples needed to reduce the width by half we
 solve
\begin_inset Formula 
\begin{align*}
\sqrt{\sigma^{2}/10000} & =2\sqrt{\sigma^{2}/N}\\
\Rightarrow & N=40000.
\end{align*}

\end_inset

So we need 30000 additional samples.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Standard

\shape smallcaps
Good luck!
\end_layout

\begin_layout Standard

\shape smallcaps
\begin_inset VSpace smallskip
\end_inset


\end_layout

\begin_layout Standard

\shape smallcaps
Mattias and Per
\begin_inset VSpace bigskip
\end_inset


\end_layout

\end_body
\end_document
